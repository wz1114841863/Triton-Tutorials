# 针对 RTX 3060 (Ampere 架构)
export TORCH_CUDA_ARCH_LIST="8.6"

Embedding的逻辑是查表，

输入： 一堆整数索引 indices（比如 [10, 5025, 99]）。

动作： 去巨大的 Weight 矩阵里，把第 10 行、第 5025 行、第 99 行复制出来。

输出： 拼成一个新的矩阵。

纯粹的Memory Bound算子。
```
python ./embedding.py
--------------------------------------------------------------------------------------------------------------
                                             MaxV=1024, SeqLen=2048, EmbSize=512
                out_f32: ['-0.50399077 ', '-0.48616108 ', '-0.45939291 '], time:0.251567ms
              out_f32x4: ['-0.50399077 ', '-0.48616108 ', '-0.45939291 '], time:0.250602ms
         out_f32x4_pack: ['-0.50399077 ', '-0.48616108 ', '-0.45939291 '], time:0.253153ms
             out_f32_th: ['-0.50399077 ', '-0.48616108 ', '-0.45939291 '], time:0.285208ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['-0.37792969 ', '0.85009766  ', '0.46484375  '], time:0.052917ms
              out_f16x8: ['-0.37792969 ', '0.85009766  ', '0.46484375  '], time:0.047696ms
         out_f16x8_pack: ['-0.37792969 ', '0.85009766  ', '0.46484375  '], time:0.024235ms
             out_f16_th: ['-0.37792969 ', '0.85009766  ', '0.46484375  '], time:0.122249ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=1024, SeqLen=2048, EmbSize=1024
                out_f32: ['0.24236262  ', '0.89561266  ', '1.83955908  '], time:0.576425ms
              out_f32x4: ['0.24236262  ', '0.89561266  ', '1.83955908  '], time:0.546885ms
         out_f32x4_pack: ['0.24236262  ', '0.89561266  ', '1.83955908  '], time:0.575268ms
             out_f32_th: ['0.24236262  ', '0.89561266  ', '1.83955908  '], time:0.674117ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['0.46191406  ', '-0.62207031 ', '-0.41625977 '], time:0.229263ms
              out_f16x8: ['0.46191406  ', '-0.62207031 ', '-0.41625977 '], time:0.240755ms
         out_f16x8_pack: ['0.46191406  ', '-0.62207031 ', '-0.41625977 '], time:0.262272ms
             out_f16_th: ['0.46191406  ', '-0.62207031 ', '-0.41625977 '], time:0.278401ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=1024, SeqLen=4096, EmbSize=512
                out_f32: ['-1.03745568 ', '0.39143196  ', '0.02529543  '], time:0.520742ms
              out_f32x4: ['-1.03745568 ', '0.39143196  ', '0.02529543  '], time:0.472081ms
         out_f32x4_pack: ['-1.03745568 ', '0.39143196  ', '0.02529543  '], time:0.509930ms
             out_f32_th: ['-1.03745568 ', '0.39143196  ', '0.02529543  '], time:0.542223ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['-0.18676758 ', '-0.16491699 ', '0.2220459   '], time:0.195098ms
              out_f16x8: ['-0.18676758 ', '-0.16491699 ', '0.2220459   '], time:0.187731ms
         out_f16x8_pack: ['-0.18676758 ', '-0.16491699 ', '0.2220459   '], time:0.203574ms
             out_f16_th: ['-0.18676758 ', '-0.16491699 ', '0.2220459   '], time:0.239754ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=1024, SeqLen=4096, EmbSize=1024
                out_f32: ['0.20300341  ', '-0.87296444 ', '0.37221703  '], time:1.123834ms
              out_f32x4: ['0.20300341  ', '-0.87296444 ', '0.37221703  '], time:1.077104ms
         out_f32x4_pack: ['0.20300341  ', '-0.87296444 ', '0.37221703  '], time:1.138365ms
             out_f32_th: ['0.20300341  ', '-0.87296444 ', '0.37221703  '], time:1.243615ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['1.54882812  ', '1.09960938  ', '-0.20373535 '], time:0.444376ms
              out_f16x8: ['1.54882812  ', '1.09960938  ', '-0.20373535 '], time:0.461066ms
         out_f16x8_pack: ['1.54882812  ', '1.09960938  ', '-0.20373535 '], time:0.507343ms
             out_f16_th: ['1.54882812  ', '1.09960938  ', '-0.20373535 '], time:0.540292ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=4096, SeqLen=2048, EmbSize=512
                out_f32: ['0.28556931  ', '0.06905501  ', '-0.87279457 '], time:0.313509ms
              out_f32x4: ['0.28556931  ', '0.06905501  ', '-0.87279457 '], time:0.298131ms
         out_f32x4_pack: ['0.28556931  ', '0.06905501  ', '-0.87279457 '], time:0.304723ms
             out_f32_th: ['0.28556931  ', '0.06905501  ', '-0.87279457 '], time:0.331640ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['2.30664062  ', '-1.19238281 ', '1.15332031  '], time:0.130510ms
              out_f16x8: ['2.30664062  ', '-1.19238281 ', '1.15332031  '], time:0.111222ms
         out_f16x8_pack: ['2.30664062  ', '-1.19238281 ', '1.15332031  '], time:0.108206ms
             out_f16_th: ['2.30664062  ', '-1.19238281 ', '1.15332031  '], time:0.172794ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=4096, SeqLen=2048, EmbSize=1024
                out_f32: ['0.30078986  ', '0.09379974  ', '-0.21878409 '], time:0.597823ms
              out_f32x4: ['0.30078986  ', '0.09379974  ', '-0.21878409 '], time:0.598764ms
         out_f32x4_pack: ['0.30078986  ', '0.09379974  ', '-0.21878409 '], time:0.620830ms
             out_f32_th: ['0.30078986  ', '0.09379974  ', '-0.21878409 '], time:0.640845ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['-0.51660156 ', '-1.48144531 ', '-2.73046875 '], time:0.299513ms
              out_f16x8: ['-0.51660156 ', '-1.48144531 ', '-2.73046875 '], time:0.295246ms
         out_f16x8_pack: ['-0.51660156 ', '-1.48144531 ', '-2.73046875 '], time:0.303876ms
             out_f16_th: ['-0.51660156 ', '-1.48144531 ', '-2.73046875 '], time:0.315905ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=4096, SeqLen=4096, EmbSize=512
                out_f32: ['1.94157457  ', '-0.70419914 ', '-0.47548282 '], time:0.607240ms
              out_f32x4: ['1.94157457  ', '-0.70419914 ', '-0.47548282 '], time:0.578809ms
         out_f32x4_pack: ['1.94157457  ', '-0.70419914 ', '-0.47548282 '], time:0.604951ms
             out_f32_th: ['1.94157457  ', '-0.70419914 ', '-0.47548282 '], time:0.631917ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['0.98681641  ', '-0.17529297 ', '-0.01412201 '], time:0.280130ms
              out_f16x8: ['0.98681641  ', '-0.17529297 ', '-0.01412201 '], time:0.271094ms
         out_f16x8_pack: ['0.98681641  ', '-0.17529297 ', '-0.01412201 '], time:0.291073ms
             out_f16_th: ['0.98681641  ', '-0.17529297 ', '-0.01412201 '], time:0.302374ms
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
                                             MaxV=4096, SeqLen=4096, EmbSize=1024
                out_f32: ['0.55300599  ', '0.64731467  ', '-0.1457945  '], time:1.168716ms
              out_f32x4: ['0.55300599  ', '0.64731467  ', '-0.1457945  '], time:1.189256ms
         out_f32x4_pack: ['0.55300599  ', '0.64731467  ', '-0.1457945  '], time:1.238036ms
             out_f32_th: ['0.55300599  ', '0.64731467  ', '-0.1457945  '], time:1.325071ms
--------------------------------------------------------------------------------------------------------------
                out_f16: ['-2.5390625  ', '0.84912109  ', '-0.80078125 '], time:0.604892ms
              out_f16x8: ['-2.5390625  ', '0.84912109  ', '-0.80078125 '], time:0.579619ms
         out_f16x8_pack: ['-2.5390625  ', '0.84912109  ', '-0.80078125 '], time:0.614369ms
             out_f16_th: ['-2.5390625  ', '0.84912109  ', '-0.80078125 '], time:0.636888ms
--------------------------------------------------------------------------------------------------------------
```
