# 针对 RTX 3060 (Ampere 架构)
export TORCH_CUDA_ARCH_LIST="8.6"
```
python3 block_all_reduce.py
--------------------------------------------------------------------------------
                                        S=1024, K=1024
               out_f32f32: -899.77221680  , time:0.16256762ms
             out_f32x4f32: -899.77270508  , time:0.16098809ms
            out_f32f32_th: -899.77233887  , time:0.16401649ms
--------------------------------------------------------------------------------
               out_f16f16: -900.45617676  , time:0.04176974ms
               out_f16f32: -899.64538574  , time:0.04702282ms
             out_f16x2f32: -899.71209717  , time:0.02213550ms
             out_f16x2f16: -900.13183594  , time:0.02419329ms
         out_f16x8packf16: -899.03564453  , time:0.01251316ms
         out_f16x8packf32: -899.64544678  , time:0.01187849ms
            out_f16f16_th: -899.50000000  , time:0.01744962ms
--------------------------------------------------------------------------------
             out_bf16bf16: -911.03125000  , time:0.05132461ms
              out_bf16f32: -900.36682129  , time:0.04926682ms
            out_bf16x2f32: -903.11932373  , time:0.02136350ms
           out_bf16x2bf16: -896.14062500  , time:0.02255654ms
        out_bf16x8packf32: -898.32263184  , time:0.01515555ms
       out_bf16x8packbf16: -893.90625000  , time:0.01501846ms
          out_bf16bf16_th: -900.00000000  , time:0.02004194ms
--------------------------------------------------------------------------------
            out_f8e4m3f16: -894.69140625  , time:0.07091308ms
     out_f8e4m3x16packf16: -894.48046875  , time:0.02777576ms
         out_f8e4m3f16_th: -895.00000000  , time:0.02097392ms
--------------------------------------------------------------------------------
            out_f8e5m2f16: -852.86328125  , time:0.05861807ms
     out_f8e5m2x16packf16: -853.45703125  , time:0.01259542ms
         out_f8e5m2f16_th: -852.50000000  , time:0.01964951ms
--------------------------------------------------------------------------------
                out_i8i32: -152           , time:0.04809880ms
         out_i8x16packi32: -152           , time:0.01109004ms
             out_i8i32_th: -152           , time:0.70805693ms
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
                                        S=1024, K=2048
               out_f32f32: -1892.21057129 , time:0.32119083ms
             out_f32x4f32: -1892.21130371 , time:0.31227565ms
            out_f32f32_th: -1892.21044922 , time:0.31846023ms
--------------------------------------------------------------------------------
               out_f16f16: -1892.25280762 , time:0.20818353ms
               out_f16f32: -1892.46105957 , time:0.20899177ms
             out_f16x2f32: -1892.66040039 , time:0.16378331ms
             out_f16x2f16: -1893.58300781 , time:0.16456199ms
         out_f16x8packf16: -1893.48291016 , time:0.16499758ms
         out_f16x8packf32: -1892.46118164 , time:0.16187429ms
            out_f16f16_th: -1892.00000000 , time:0.17045975ms
--------------------------------------------------------------------------------
             out_bf16bf16: -1877.90625000 , time:0.21015215ms
              out_bf16f32: -1885.96008301 , time:0.20717216ms
            out_bf16x2f32: -1885.93359375 , time:0.16385484ms
           out_bf16x2bf16: -1889.09375000 , time:0.16589642ms
        out_bf16x8packf32: -1887.93640137 , time:0.17287898ms
       out_bf16x8packbf16: -1888.43750000 , time:0.16020989ms
          out_bf16bf16_th: -1888.00000000 , time:0.16466761ms
--------------------------------------------------------------------------------
            out_f8e4m3f16: -1928.95898438 , time:0.10896564ms
     out_f8e4m3x16packf16: -1929.10156250 , time:0.03311920ms
         out_f8e4m3f16_th: -1929.00000000 , time:0.16913962ms
--------------------------------------------------------------------------------
            out_f8e5m2f16: -1947.18750000 , time:0.08977818ms
     out_f8e5m2x16packf16: -1949.01562500 , time:0.01459336ms
         out_f8e5m2f16_th: -1948.00000000 , time:0.17607880ms
--------------------------------------------------------------------------------
                out_i8i32: -549           , time:0.09131837ms
         out_i8x16packi32: -549           , time:0.01329017ms
             out_i8i32_th: -549           , time:1.40995979ms
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
                                        S=1024, K=4096
               out_f32f32: 2698.83129883  , time:0.61651325ms
             out_f32x4f32: 2698.83374023  , time:0.61534286ms
            out_f32f32_th: 2698.83251953  , time:0.63887000ms
--------------------------------------------------------------------------------
               out_f16f16: 2697.96777344  , time:0.42353773ms
               out_f16f32: 2699.61791992  , time:0.40314651ms
             out_f16x2f32: 2699.71801758  , time:0.31893086ms
             out_f16x2f16: 2698.69262695  , time:0.32132745ms
         out_f16x8packf16: 2699.45117188  , time:0.31224751ms
         out_f16x8packf32: 2699.60839844  , time:0.31970787ms
            out_f16f16_th: 2700.00000000  , time:0.33604193ms
--------------------------------------------------------------------------------
             out_bf16bf16: 2708.76562500  , time:0.42916107ms
              out_bf16f32: 2696.57348633  , time:0.40380073ms
            out_bf16x2f32: 2699.87158203  , time:0.31722522ms
           out_bf16x2bf16: 2699.37500000  , time:0.31348062ms
        out_bf16x8packf32: 2693.00561523  , time:0.32572126ms
       out_bf16x8packbf16: 2699.68750000  , time:0.31050634ms
          out_bf16bf16_th: 2704.00000000  , time:0.31443810ms
--------------------------------------------------------------------------------
            out_f8e4m3f16: 2676.49804688  , time:0.41643858ms
     out_f8e4m3x16packf16: 2675.30859375  , time:0.16684675ms
         out_f8e4m3f16_th: 2676.00000000  , time:0.32097721ms
--------------------------------------------------------------------------------
            out_f8e5m2f16: 2537.93750000  , time:0.35291791ms
     out_f8e5m2x16packf16: 2536.47265625  , time:0.16096163ms
         out_f8e5m2f16_th: 2536.00000000  , time:0.34678125ms
--------------------------------------------------------------------------------
                out_i8i32: 1172           , time:-2.15186095ms
         out_i8x16packi32: 1172           , time:0.15962005ms
             out_i8i32_th: 1172           , time:2.80313706ms
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
                                        S=2048, K=1024
               out_f32f32: 712.03570557   , time:0.33109879ms
             out_f32x4f32: 712.03662109   , time:0.31749344ms
            out_f32f32_th: 712.03601074   , time:0.32238746ms
--------------------------------------------------------------------------------
               out_f16f16: 711.63476562   , time:0.21212363ms
               out_f16f32: 711.78936768   , time:0.21125245ms
             out_f16x2f32: 712.49194336   , time:0.17343664ms
             out_f16x2f16: 712.78686523   , time:0.17145491ms
         out_f16x8packf16: 712.33203125   , time:0.16354918ms
         out_f16x8packf32: 711.78936768   , time:0.16164446ms
            out_f16f16_th: 712.00000000   , time:0.16522717ms
--------------------------------------------------------------------------------
             out_bf16bf16: 716.01562500   , time:0.22313929ms
              out_bf16f32: 719.26507568   , time:0.21217465ms
            out_bf16x2f32: 715.69445801   , time:0.17150927ms
           out_bf16x2bf16: 715.01562500   , time:0.16823673ms
        out_bf16x8packf32: 724.24768066   , time:0.16547918ms
       out_bf16x8packbf16: 727.04687500   , time:0.16014123ms
          out_bf16bf16_th: 720.00000000   , time:0.17527843ms
--------------------------------------------------------------------------------
            out_f8e4m3f16: 734.41210938   , time:0.11006594ms
     out_f8e4m3x16packf16: 734.15039062   , time:0.03472733ms
         out_f8e4m3f16_th: 734.50000000   , time:0.17506957ms
--------------------------------------------------------------------------------
            out_f8e5m2f16: 769.52148438   , time:0.09011340ms
     out_f8e5m2x16packf16: 769.28027344   , time:0.02101707ms
         out_f8e5m2f16_th: 770.00000000   , time:0.17072535ms
--------------------------------------------------------------------------------
                out_i8i32: 182            , time:0.08384371ms
         out_i8x16packi32: 182            , time:0.01458335ms
             out_i8i32_th: 182            , time:1.42430067ms
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
                                        S=2048, K=2048
               out_f32f32: -4491.29882812 , time:0.62409163ms
             out_f32x4f32: -4491.28955078 , time:0.65464306ms
            out_f32f32_th: -4491.29101562 , time:0.63321066ms
--------------------------------------------------------------------------------
               out_f16f16: -4489.11962891 , time:0.41390228ms
               out_f16f32: -4490.72802734 , time:0.41608739ms
             out_f16x2f32: -4489.95214844 , time:0.32179213ms
             out_f16x2f16: -4488.49853516 , time:0.32178068ms
         out_f16x8packf16: -4491.16162109 , time:0.31811666ms
         out_f16x8packf32: -4490.72509766 , time:0.31657600ms
            out_f16f16_th: -4492.00000000 , time:0.34484673ms
--------------------------------------------------------------------------------
             out_bf16bf16: -4494.96093750 , time:0.44538713ms
              out_bf16f32: -4491.37402344 , time:0.41360378ms
            out_bf16x2f32: -4490.87646484 , time:0.31507039ms
           out_bf16x2bf16: -4493.40625000 , time:0.34455919ms
        out_bf16x8packf32: -4502.30175781 , time:0.31447339ms
       out_bf16x8packbf16: -4501.10937500 , time:0.31017351ms
          out_bf16bf16_th: -4480.00000000 , time:0.31942439ms
--------------------------------------------------------------------------------
            out_f8e4m3f16: -4402.72851562 , time:0.40880013ms
     out_f8e4m3x16packf16: -4407.11718750 , time:0.16641474ms
         out_f8e4m3f16_th: -4404.00000000 , time:0.31702161ms
--------------------------------------------------------------------------------
            out_f8e5m2f16: -4498.41210938 , time:0.36675429ms
     out_f8e5m2x16packf16: -4499.98828125 , time:0.16172028ms
         out_f8e5m2f16_th: -4500.00000000 , time:0.31783676ms
--------------------------------------------------------------------------------
                out_i8i32: -2669          , time:0.34786892ms
         out_i8x16packi32: -2669          , time:0.15983415ms
             out_i8i32_th: -2669          , time:2.76520491ms
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
                                        S=2048, K=4096
               out_f32f32: 3111.27832031  , time:1.23083901ms
             out_f32x4f32: 3111.29321289  , time:1.21756268ms
            out_f32f32_th: 3111.28979492  , time:1.25843430ms
--------------------------------------------------------------------------------
               out_f16f16: 3111.17407227  , time:0.84051895ms
               out_f16f32: 3111.07373047  , time:0.82575369ms
             out_f16x2f32: 3111.23583984  , time:0.63175941ms
             out_f16x2f16: 3110.23291016  , time:0.62205172ms
         out_f16x8packf16: 3113.06103516  , time:0.63071704ms
         out_f16x8packf32: 3111.06958008  , time:0.61044478ms
            out_f16f16_th: 3112.00000000  , time:0.62673950ms
--------------------------------------------------------------------------------
             out_bf16bf16: 3091.67968750  , time:0.86648822ms
              out_bf16f32: 3102.52880859  , time:0.82975650ms
            out_bf16x2f32: 3105.82055664  , time:0.64569330ms
           out_bf16x2bf16: 3133.10937500  , time:-1.84339929ms
        out_bf16x8packf32: 3114.60913086  , time:0.62832284ms
       out_bf16x8packbf16: 3114.00000000  , time:0.62451887ms
          out_bf16bf16_th: 3104.00000000  , time:0.68529797ms
--------------------------------------------------------------------------------
            out_f8e4m3f16: 3187.41601562  , time:0.82644486ms
     out_f8e4m3x16packf16: 3188.03906250  , time:0.33792090ms
         out_f8e4m3f16_th: 3190.00000000  , time:0.62514353ms
--------------------------------------------------------------------------------
            out_f8e5m2f16: 2974.95898438  , time:0.74527717ms
     out_f8e5m2x16packf16: 2973.44140625  , time:0.31738400ms
         out_f8e5m2f16_th: 2972.00000000  , time:0.63030624ms
--------------------------------------------------------------------------------
                out_i8i32: 902            , time:0.72587895ms
         out_i8x16packi32: 902            , time:0.31865454ms
             out_i8i32_th: 902            , time:6.26204467ms
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
                                        S=4096, K=1024
               out_f32f32: -2643.29882812 , time:0.60907197ms
             out_f32x4f32: -2643.30004883 , time:0.60775137ms
            out_f32f32_th: -2643.30468750 , time:0.63617516ms
--------------------------------------------------------------------------------
               out_f16f16: -2644.13549805 , time:0.43275070ms
               out_f16f32: -2643.66015625 , time:0.54602981ms
             out_f16x2f32: -2643.04565430 , time:0.49985313ms
             out_f16x2f16: -2641.37109375 , time:0.34205270ms
         out_f16x8packf16: -2643.39160156 , time:0.37207747ms
         out_f16x8packf32: -2643.65966797 , time:0.34934163ms
            out_f16f16_th: -2644.00000000 , time:0.31973076ms
--------------------------------------------------------------------------------
             out_bf16bf16: -2643.87500000 , time:0.51030326ms
              out_bf16f32: -2646.10864258 , time:0.41299415ms
            out_bf16x2f32: -2643.74780273 , time:0.53320765ms
           out_bf16x2bf16: -2629.19531250 , time:0.43780804ms
        out_bf16x8packf32: -2646.91894531 , time:0.35442209ms
       out_bf16x8packbf16: -2633.11718750 , time:0.31095314ms
          out_bf16bf16_th: -2640.00000000 , time:0.31483006ms
--------------------------------------------------------------------------------
            out_f8e4m3f16: -2628.65039062 , time:0.41078734ms
     out_f8e4m3x16packf16: -2628.95703125 , time:0.16841197ms
         out_f8e4m3f16_th: -2630.00000000 , time:0.32446718ms
--------------------------------------------------------------------------------
            out_f8e5m2f16: -2776.54296875 , time:0.35430694ms
     out_f8e5m2x16packf16: -2778.58398438 , time:0.17161012ms
         out_f8e5m2f16_th: -2778.00000000 , time:0.31377482ms
--------------------------------------------------------------------------------
                out_i8i32: -991           , time:0.35236502ms
         out_i8x16packi32: -991           , time:0.15957999ms
             out_i8i32_th: -991           , time:3.34554958ms
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
                                        S=4096, K=2048
               out_f32f32: 5667.52343750  , time:1.20757127ms
             out_f32x4f32: 5667.52636719  , time:1.20291591ms
            out_f32f32_th: 5667.52685547  , time:1.20875669ms
--------------------------------------------------------------------------------
               out_f16f16: 5666.26708984  , time:0.83464289ms
               out_f16f32: 5668.17333984  , time:0.81859517ms
             out_f16x2f32: 5668.63916016  , time:0.61777163ms
             out_f16x2f16: 5667.90673828  , time:-1.85415030ms
         out_f16x8packf16: 5669.64257812  , time:0.60803437ms
         out_f16x8packf32: 5668.16601562  , time:0.60782456ms
            out_f16f16_th: 5668.00000000  , time:0.61383009ms
--------------------------------------------------------------------------------
             out_bf16bf16: 5669.42187500  , time:0.87244916ms
              out_bf16f32: 5658.30078125  , time:0.80992174ms
            out_bf16x2f32: 5657.64550781  , time:0.60826874ms
           out_bf16x2bf16: 5666.00000000  , time:0.61315084ms
        out_bf16x8packf32: 5649.32275391  , time:0.60795856ms
       out_bf16x8packbf16: 5646.35937500  , time:0.60766578ms
          out_bf16bf16_th: 5664.00000000  , time:0.61356616ms
--------------------------------------------------------------------------------
            out_f8e4m3f16: 5758.83398438  , time:0.81178498ms
     out_f8e4m3x16packf16: 5763.92187500  , time:0.36274409ms
         out_f8e4m3f16_th: 5760.00000000  , time:0.61453271ms
--------------------------------------------------------------------------------
            out_f8e5m2f16: 5674.25976562  , time:0.74689269ms
     out_f8e5m2x16packf16: 5677.74609375  , time:0.30995011ms
         out_f8e5m2f16_th: 5676.00000000  , time:0.61242318ms
--------------------------------------------------------------------------------
                out_i8i32: 3754           , time:0.69010687ms
         out_i8x16packi32: 3754           , time:0.30944991ms
             out_i8i32_th: 3754           , time:5.39765668ms
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
                                        S=4096, K=4096
               out_f32f32: 2089.48486328  , time:2.41379952ms
             out_f32x4f32: 2089.48364258  , time:2.39824224ms
            out_f32f32_th: 2089.48583984  , time:2.41037321ms
--------------------------------------------------------------------------------
               out_f16f16: 2091.05981445  , time:1.66866684ms
               out_f16f32: 2089.75292969  , time:1.64640713ms
             out_f16x2f32: 2090.24926758  , time:1.20413804ms
             out_f16x2f16: 2088.80834961  , time:1.20473456ms
         out_f16x8packf16: 2089.77783203  , time:1.20328546ms
         out_f16x8packf32: 2089.75561523  , time:-1.29725504ms
            out_f16f16_th: 2090.00000000  , time:1.21175241ms
--------------------------------------------------------------------------------
             out_bf16bf16: 2100.25781250  , time:1.72100711ms
              out_bf16f32: 2092.16479492  , time:1.60963655ms
            out_bf16x2f32: 2101.58911133  , time:1.20249176ms
           out_bf16x2bf16: 2121.46093750  , time:1.20669508ms
        out_bf16x8packf32: 2084.74243164  , time:1.20304680ms
       out_bf16x8packbf16: 2072.90625000  , time:1.20287275ms
          out_bf16bf16_th: 2096.00000000  , time:1.21061516ms
--------------------------------------------------------------------------------
            out_f8e4m3f16: 2142.81640625  , time:1.59470034ms
     out_f8e4m3x16packf16: 2139.16406250  , time:0.73447537ms
         out_f8e4m3f16_th: 2140.00000000  , time:1.21052313ms
--------------------------------------------------------------------------------
            out_f8e5m2f16: 2096.35351562  , time:1.45403051ms
     out_f8e5m2x16packf16: 2093.72851562  , time:0.60720778ms
         out_f8e5m2f16_th: 2094.00000000  , time:1.20991349ms
--------------------------------------------------------------------------------
                out_i8i32: -1358          , time:1.36430812ms
         out_i8x16packi32: -1358          , time:0.60719156ms
             out_i8i32_th: -1358          , time:11.31084681ms
--------------------------------------------------------------------------------
````
