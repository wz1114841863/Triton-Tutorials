# 针对 RTX 3060 (Ampere 架构)
export TORCH_CUDA_ARCH_LIST="8.6"

Swish原始公式

$f(x) = x \cdot \sigma(x) = \frac{x}{1 + e^{-x}}$

Swish近似公式

$f(x) = \begin{cases} 0 & x \le -3 \\ x & x \ge 3 \\ x \cdot \frac{x+3}{6} & \text{otherwise} \end{cases}$

```
 python ./hardswish.py
-------------------------------------------------------------------------------------
                                        S=1024, K=1024
           out_f32: ['-0.09087595 ', '-0.19966981 '], time:0.31369472ms
         out_f32x4: ['-0.09087595 ', '-0.19966981 '], time:0.30655813ms
        out_f32_th: ['-0.09087595 ', '-0.19966981 '], time:0.61036611ms
-------------------------------------------------------------------------------------
           out_f16: ['-0.09082031 ', '-0.19970703 '], time:0.14934111ms
         out_f16x2: ['-0.09082031 ', '-0.19970703 '], time:0.14703989ms
         out_f16x8: ['-0.09082031 ', '-0.19970703 '], time:0.13656521ms
     out_f16x8pack: ['-0.09082031 ', '-0.19970703 '], time:0.13613367ms
        out_f16_th: ['-0.09088135 ', '-0.19970703 '], time:0.23778081ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=1024, K=2048
           out_f32: ['0.72496599  ', '-0.08072048 '], time:0.62714863ms
         out_f32x4: ['0.72496599  ', '-0.08072048 '], time:0.62577343ms
        out_f32_th: ['0.72496599  ', '-0.08072048 '], time:1.26757288ms
-------------------------------------------------------------------------------------
           out_f16: ['0.72509766  ', '-0.08074951 '], time:0.31555486ms
         out_f16x2: ['0.72509766  ', '-0.08074951 '], time:0.32043099ms
         out_f16x8: ['0.72509766  ', '-0.08074951 '], time:0.30684233ms
     out_f16x8pack: ['0.72509766  ', '-0.08074951 '], time:0.29839301ms
        out_f16_th: ['0.72509766  ', '-0.08074951 '], time:0.59278154ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=1024, K=4096
           out_f32: ['-0.23264629 ', '1.49112821  '], time:1.27236485ms
         out_f32x4: ['-0.23264629 ', '1.49112821  '], time:1.27650785ms
        out_f32_th: ['-0.23264629 ', '1.49112821  '], time:2.51196575ms
-------------------------------------------------------------------------------------
           out_f16: ['-0.23254395 ', '1.48925781  '], time:0.62932348ms
         out_f16x2: ['-0.23254395 ', '1.48925781  '], time:0.63154721ms
         out_f16x8: ['-0.23254395 ', '1.48925781  '], time:0.61902666ms
     out_f16x8pack: ['-0.23254395 ', '1.48925781  '], time:0.62349796ms
        out_f16_th: ['-0.23266602 ', '1.49023438  '], time:1.25279880ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=2048, K=1024
           out_f32: ['-0.35585234 ', '-0.13892801 '], time:0.62963748ms
         out_f32x4: ['-0.35585234 ', '-0.13892801 '], time:0.62532520ms
        out_f32_th: ['-0.35585234 ', '-0.13892801 '], time:1.25009680ms
-------------------------------------------------------------------------------------
           out_f16: ['-0.35571289 ', '-0.13879395 '], time:0.30798531ms
         out_f16x2: ['-0.35571289 ', '-0.13879395 '], time:0.31560802ms
         out_f16x8: ['-0.35571289 ', '-0.13879395 '], time:0.30600786ms
     out_f16x8pack: ['-0.35571289 ', '-0.13879395 '], time:0.30602694ms
        out_f16_th: ['-0.35595703 ', '-0.13891602 '], time:0.61432552ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=2048, K=2048
           out_f32: ['0.90218246  ', '1.73021936  '], time:1.28911948ms
         out_f32x4: ['0.90218246  ', '1.73021936  '], time:1.26905131ms
        out_f32_th: ['0.90218246  ', '1.73021936  '], time:2.52295446ms
-------------------------------------------------------------------------------------
           out_f16: ['0.90283203  ', '1.73046875  '], time:0.62850857ms
         out_f16x2: ['0.90283203  ', '1.73046875  '], time:0.62932968ms
         out_f16x8: ['0.90283203  ', '1.73046875  '], time:0.63099623ms
     out_f16x8pack: ['0.90283203  ', '1.73046875  '], time:0.62576008ms
        out_f16_th: ['0.90234375  ', '1.73144531  '], time:1.28487849ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=2048, K=4096
           out_f32: ['-0.00633597 ', '-0.12439786 '], time:2.52596712ms
         out_f32x4: ['-0.00633597 ', '-0.12439786 '], time:2.54685378ms
        out_f32_th: ['-0.00633597 ', '-0.12439786 '], time:5.07650566ms
-------------------------------------------------------------------------------------
           out_f16: ['-0.0063324  ', '-0.12426758 '], time:1.28359365ms
         out_f16x2: ['-0.0063324  ', '-0.12426758 '], time:1.27017045ms
         out_f16x8: ['-0.0063324  ', '-0.12426758 '], time:1.25584698ms
     out_f16x8pack: ['-0.0063324  ', '-0.12426758 '], time:1.26705885ms
        out_f16_th: ['-0.00633621 ', '-0.12426758 '], time:2.58093095ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=4096, K=1024
           out_f32: ['0.29218692  ', '-0.17174655 '], time:1.44678664ms
         out_f32x4: ['0.29218692  ', '-0.17174655 '], time:1.25797462ms
        out_f32_th: ['0.29218692  ', '-0.17174655 '], time:2.51925302ms
-------------------------------------------------------------------------------------
           out_f16: ['0.29223633  ', '-0.17175293 '], time:0.62514424ms
         out_f16x2: ['0.29223633  ', '-0.17175293 '], time:0.63216281ms
         out_f16x8: ['0.29223633  ', '-0.17175293 '], time:0.62297869ms
     out_f16x8pack: ['0.29223633  ', '-0.17175293 '], time:0.62840104ms
        out_f16_th: ['0.29223633  ', '-0.17175293 '], time:1.25705743ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=4096, K=2048
           out_f32: ['0.68563211  ', '-0.2960968  '], time:2.52393365ms
         out_f32x4: ['0.68563211  ', '-0.2960968  '], time:2.52800345ms
        out_f32_th: ['0.68563211  ', '-0.2960968  '], time:5.02020502ms
-------------------------------------------------------------------------------------
           out_f16: ['0.68554688  ', '-0.29614258 '], time:1.25867963ms
         out_f16x2: ['0.68554688  ', '-0.29614258 '], time:1.26062465ms
         out_f16x8: ['0.68554688  ', '-0.29614258 '], time:1.24887466ms
     out_f16x8pack: ['0.68554688  ', '-0.29614258 '], time:1.26050997ms
        out_f16_th: ['0.68554688  ', '-0.29614258 '], time:2.52571893ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        S=4096, K=4096
           out_f32: ['-0.04550375 ', '0.39735633  '], time:5.03730392ms
         out_f32x4: ['-0.04550375 ', '0.39735633  '], time:5.06254315ms
        out_f32_th: ['-0.04550375 ', '0.39735633  '], time:10.54529214ms
-------------------------------------------------------------------------------------
           out_f16: ['-0.04550171 ', '0.39746094  '], time:2.51571631ms
         out_f16x2: ['-0.04550171 ', '0.39746094  '], time:2.52668118ms
         out_f16x8: ['-0.04550171 ', '0.39746094  '], time:2.51144314ms
     out_f16x8pack: ['-0.04550171 ', '0.39746094  '], time:2.53945827ms
        out_f16_th: ['-0.04550171 ', '0.39746094  '], time:5.04161930ms
-------------------------------------------------------------------------------------
```
