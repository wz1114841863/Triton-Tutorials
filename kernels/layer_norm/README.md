# 针对 RTX 3060 (Ampere 架构)
export TORCH_CUDA_ARCH_LIST="8.6"
```
python ./layer_norm.py
-------------------------------------------------------------------------------------
                                        N=4096, K=512
-------------------------------------------------------------------------------------
          out_f32: ['0.18159319  ', '-1.09115434 ', '0.48995787  '], time:0.65013313ms
        out_f32x4: ['0.18159319  ', '-1.09115434 ', '0.48995787  '], time:0.64385605ms
       out_f32_th: ['0.18141668  ', '-1.09009373 ', '0.48948163  '], time:3.20598221ms
-------------------------------------------------------------------------------------
       out_f16f16: ['0.18164062  ', '-1.09082031 ', '0.49047852  '], time:0.41155910ms
       out_f16f32: ['0.18164062  ', '-1.09082031 ', '0.49023438  '], time:0.32320166ms
     out_f16x2f16: ['0.18164062  ', '-1.09082031 ', '0.49023438  '], time:0.32544112ms
     out_f16x8f16: ['0.18164062  ', '-1.09082031 ', '0.49023438  '], time:0.32086277ms
 out_f16x8packf16: ['0.18164062  ', '-1.09082031 ', '0.49023438  '], time:0.32076359ms
 out_f16x8packf32: ['0.18164062  ', '-1.09082031 ', '0.49023438  '], time:0.32052946ms
       out_f16_th: ['0.18139648  ', '-1.08984375 ', '0.48974609  '], time:1.59771347ms
-------------------------------------------------------------------------------------
                                        f16 overflow without f32
-------------------------------------------------------------------------------------
       out_f16f16: ['0.0         ', '0.0         ', '0.0         '], time:0.35960770ms
       out_f16f32: ['0.18151855  ', '-1.09082031 ', '0.48999023  '], time:0.33961582ms
     out_f16x2f16: ['0.0         ', '0.0         ', '0.0         '], time:0.32286358ms
     out_f16x8f16: ['0.0         ', '0.0         ', '0.0         '], time:0.31842303ms
 out_f16x8packf16: ['0.0         ', '0.0         ', '0.0         '], time:0.31874347ms
 out_f16x8packf32: ['0.18151855  ', '-1.09082031 ', '0.48999023  '], time:0.31840324ms
       out_f16_th: ['0.18139648  ', '-1.08984375 ', '0.48925781  '], time:1.60249186ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        N=4096, K=1024
-------------------------------------------------------------------------------------
          out_f32: ['-1.07414591 ', '-0.63736391 ', '-0.98025787 '], time:1.29931808ms
        out_f32x4: ['-1.07414603 ', '-0.63736397 ', '-0.98025793 '], time:1.29623795ms
       out_f32_th: ['-1.07362676 ', '-0.63705581 ', '-0.97978401 '], time:6.38460565ms
-------------------------------------------------------------------------------------
       out_f16f16: ['-1.07421875 ', '-0.63671875 ', '-0.97949219 '], time:-0.15757775ms
       out_f16f32: ['-1.07421875 ', '-0.63720703 ', '-0.97998047 '], time:0.73057890ms
     out_f16x2f16: ['-1.07421875 ', '-0.63720703 ', '-0.97998047 '], time:0.65049291ms
     out_f16x8f16: ['-1.07421875 ', '-0.63671875 ', '-0.97949219 '], time:0.64365268ms
 out_f16x8packf16: ['-1.07421875 ', '-0.63671875 ', '-0.97949219 '], time:0.64639187ms
 out_f16x8packf32: ['-1.07421875 ', '-0.63720703 ', '-0.97998047 '], time:0.64636493ms
       out_f16_th: ['-1.07421875 ', '-0.63671875 ', '-0.97949219 '], time:3.20700622ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        N=4096, K=2048
-------------------------------------------------------------------------------------
        out_f32x4: ['1.26451361  ', '-0.46891889 ', '0.40681776  '], time:2.60448170ms
       out_f32_th: ['1.2642113   ', '-0.46880677 ', '0.40672049  '], time:12.74090171ms
-------------------------------------------------------------------------------------
     out_f16x2f16: ['1.265625    ', '-0.46923828 ', '0.40722656  '], time:1.31292272ms
     out_f16x8f16: ['1.26464844  ', '-0.46875    ', '0.40673828  '], time:1.29922009ms
 out_f16x8packf16: ['1.26464844  ', '-0.46875    ', '0.40673828  '], time:1.31634903ms
 out_f16x8packf32: ['1.26464844  ', '-0.46875    ', '0.40698242  '], time:1.30013895ms
       out_f16_th: ['1.26464844  ', '-0.46875    ', '0.40673828  '], time:5.37635827ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        N=4096, K=4096
-------------------------------------------------------------------------------------
        out_f32x4: ['0.12166837  ', '-0.96281058 ', '0.36118293  '], time:5.27822399ms
       out_f32_th: ['0.12165413  ', '-0.96269792 ', '0.36114064  '], time:26.15438509ms
-------------------------------------------------------------------------------------
     out_f16x8f16: ['0.1217041   ', '-0.96337891 ', '0.36108398  '], time:2.56223512ms
 out_f16x8packf16: ['0.12164307  ', '-0.96337891 ', '0.36108398  '], time:2.60609126ms
 out_f16x8packf32: ['0.12164307  ', '-0.96289062 ', '0.36108398  '], time:2.60617566ms
       out_f16_th: ['0.12164307  ', '-0.96337891 ', '0.36108398  '], time:12.82030821ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        N=4096, K=8192
-------------------------------------------------------------------------------------
     out_f16x8f16: ['-0.39672852 ', '-0.40161133 ', '0.27416992  '], time:4.03678679ms
 out_f16x8packf16: ['-0.39672852 ', '-0.40161133 ', '0.27416992  '], time:5.24932504ms
 out_f16x8packf32: ['-0.39697266 ', '-0.40185547 ', '0.27416992  '], time:5.27539754ms
       out_f16_th: ['-0.39672852 ', '-0.40161133 ', '0.27416992  '], time:24.29440308ms
-------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------
                                        N=8192, K=8192
-------------------------------------------------------------------------------------
     out_f16x8f16: ['-0.27441406 ', '2.47265625  ', '-0.71240234 '], time:10.28878117ms
 out_f16x8packf16: ['-0.27441406 ', '2.47265625  ', '-0.71240234 '], time:9.57336783ms
 out_f16x8packf32: ['-0.2746582  ', '2.47265625  ', '-0.71289062 '], time:10.63503504ms
       out_f16_th: ['-0.2746582  ', '2.47460938  ', '-0.71337891 '], time:49.53272653ms
-------------------------------------------------------------------------------------
```
